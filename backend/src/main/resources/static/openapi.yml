openapi: 3.0.1
info:
  title: API de Ventas
  description: API para gestión de ventas, cotizaciones, clientes y productos
  version: 1.0.0
  contact:
    name: Equipo de Desarrollo
    email: dev@ventas.com
servers:
  - url: http://localhost:8080
    description: Servidor de Desarrollo
  - url: https://api-ventas.azure.com
    description: Servidor de Producción

tags:
  - name: Ventas
    description: Operaciones relacionadas con ventas
  - name: Cotizaciones
    description: Operaciones relacionadas con cotizaciones
  - name: Clientes
    description: Gestión de clientes
  - name: Productos
    description: Gestión de productos
  - name: Vendedores
    description: Gestión de vendedores
  - name: Descuentos
    description: Gestión de descuentos

paths:
  /api/ventas:
    get:
      tags:
        - Ventas
      summary: Listar todas las ventas
      description: Obtiene un listado de todas las ventas registradas
      operationId: listarVentas
      responses:
        '200':
          description: Lista de ventas obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Venta'
        '500':
          description: Error interno del servidor
    post:
      tags:
        - Ventas
      summary: Crear una nueva venta
      description: Registra una nueva venta en el sistema
      operationId: crearVenta
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VentaRequest'
      responses:
        '201':
          description: Venta creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Venta'
        '400':
          description: Datos de entrada inválidos
        '500':
          description: Error interno del servidor

  /api/cotizaciones:
    get:
      tags:
        - Cotizaciones
      summary: Listar todas las cotizaciones
      operationId: listarCotizaciones
      responses:
        '200':
          description: Lista de cotizaciones obtenida exitosamente
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Cotizacion'
    post:
      tags:
        - Cotizaciones
      summary: Crear una nueva cotización
      operationId: crearCotizacion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CotizacionRequest'
      responses:
        '201':
          description: Cotización creada exitosamente
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Cotizacion'

  /api/cotizaciones/enviar:
    post:
      tags:
        - Cotizaciones
      summary: Enviar cotización por email
      operationId: enviarCotizacion
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                cotizacionId:
                  type: integer
                  format: int64
                email:
                  type: string
                  format: email
      responses:
        '200':
          description: Cotización enviada exitosamente
        '400':
          description: Datos inválidos
        '404':
          description: Cotización no encontrada

components:
  schemas:
    Venta:
      type: object
      properties:
        id:
          type: integer
          format: int64
          example: 1
        fecha:
          type: string
          format: date-time
          example: "2025-12-01T10:30:00"
        clienteId:
          type: integer
          format: int64
          example: 100
        vendedorId:
          type: integer
          format: int64
          example: 5
        total:
          type: number
          format: double
          example: 1500.50
        estado:
          type: string
          enum: [PENDIENTE, COMPLETADA, CANCELADA]
          example: COMPLETADA
        items:
          type: array
          items:
            $ref: '#/components/schemas/VentaItem'
    
    VentaRequest:
      type: object
      required:
        - clienteId
        - vendedorId
        - items
      properties:
        clienteId:
          type: integer
          format: int64
        vendedorId:
          type: integer
          format: int64
        items:
          type: array
          items:
            $ref: '#/components/schemas/VentaItemRequest'
        descuentoId:
          type: integer
          format: int64
    
    VentaItem:
      type: object
      properties:
        id:
          type: integer
          format: int64
        productoId:
          type: integer
          format: int64
        cantidad:
          type: integer
          example: 2
        precioUnitario:
          type: number
          format: double
          example: 750.25
        subtotal:
          type: number
          format: double
          example: 1500.50
    
    VentaItemRequest:
      type: object
      required:
        - productoId
        - cantidad
      properties:
        productoId:
          type: integer
          format: int64
        cantidad:
          type: integer
          minimum: 1
    
    Cotizacion:
      type: object
      properties:
        id:
          type: integer
          format: int64
        fecha:
          type: string
          format: date-time
        clienteId:
          type: integer
          format: int64
        vendedorId:
          type: integer
          format: int64
        total:
          type: number
          format: double
        estado:
          type: string
          enum: [BORRADOR, ENVIADA, ACEPTADA, RECHAZADA, VENCIDA]
        vigencia:
          type: string
          format: date
        items:
          type: array
          items:
            $ref: '#/components/schemas/CotizacionItem'
    
    CotizacionRequest:
      type: object
      required:
        - clienteId
        - vendedorId
        - items
      properties:
        clienteId:
          type: integer
          format: int64
        vendedorId:
          type: integer
          format: int64
        vigencia:
          type: string
          format: date
        items:
          type: array
          items:
            $ref: '#/components/schemas/CotizacionItemRequest'
    
    CotizacionItem:
      type: object
      properties:
        id:
          type: integer
          format: int64
        productoId:
          type: integer
          format: int64
        cantidad:
          type: integer
        precioUnitario:
          type: number
          format: double
        subtotal:
          type: number
          format: double
    
    CotizacionItemRequest:
      type: object
      required:
        - productoId
        - cantidad
      properties:
        productoId:
          type: integer
          format: int64
        cantidad:
          type: integer
          minimum: 1

